void set_vga_mode_13h() {
    outb(0x3C2, 0x63);
    outb(0x3D4, 0x11);
    outb(0x3D5, 0x80);

    uint8_t crt_reg[] = {
        0x5F, 0x4F, 0x50, 0x82, 0x54, 0x80, 0xBF, 0x1F,
        0x00, 0x41, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x9C, 0x0E, 0x8F, 0x28, 0x40, 0x96, 0xB9, 0xA3,
        0xFF
    };

    for (int i = 0; i < sizeof(crt_reg); i++) {
        outb(0x3D4, i);
        outb(0x3D5, crt_reg[i]);
    }

    for (int i = 0; i < 0x20; i++) {
        inb(0x3DA);
        outb(0x3C0, i);
        outb(0x3C0, i & 0x1F);
    }

    uint8_t gctrl_reg[] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x05, 0x0F, 0xFF};
    for (int i = 0; i < sizeof(gctrl_reg); i++) {
        outb(0x3CE, i);
        outb(0x3CF, gctrl_reg[i]);
    }

    uint8_t seq_reg[] = {0x03, 0x01, 0x0F, 0x00, 0x0E};
    for (int i = 0; i < sizeof(seq_reg); i++) {
        outb(0x3C4, i);
        outb(0x3C5, seq_reg[i]);
    }

    inb(0x3DA);
    outb(0x3C0, 0x20);
}

void draw_pixel(int x, int y, uint8_t color) {
    uint8_t *vga_buffer = (uint8_t *)0xA0000;
    int offset = y * 320 + x;
    vga_buffer[offset] = color;
}
